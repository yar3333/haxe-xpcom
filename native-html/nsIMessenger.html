<!DOCTYPE html>
<html lang="en-US" dir="ltr" class="redesign no-js">

<!-- Mirrored from developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Aug 2014 20:19:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <script>(function(d) { d.className = d.className.replace(/\bno-js/, ''); })(document.documentElement);</script>
        
    <title>nsIMessenger - Mozilla | MDN</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="index, follow">
  <link rel="home" href="https://developer.mozilla.org/en-US/">
  <link rel="copyright" href="#copyright">

  <link href="../../../../../../../../mozorg.cdn.mozilla.net/media/css/tabzilla-min.css" type="text/css" rel="stylesheet">
              <link rel="stylesheet" media="all" href="../../../../../../../../developer.cdn.mozilla.net/media/css/mdn-min46d5.css?build=9fd3034" />

      
    <link rel="stylesheet" media="all" href="../../../../../../../../developer.cdn.mozilla.net/media/css/wiki-min46d5.css?build=9fd3034" />

          <link rel="stylesheet" type="text/css"
            href="https://developer.mozilla.org/en-US/docs/Template:CustomCSS?raw=1" />
    
    
  <!-- common social tags -->
    <meta property="og:type" content="website">
  <meta property="og:image" content="https://developer.mozilla.org/media/redesign/img/opengraph-logo.png">
  <meta property="og:site_name" content="Mozilla Developer Network">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="https://developer.mozilla.org/media/redesign/img/opengraph-logo.png">
  <meta name="twitter:site" content="@NewOnMDN">
  <meta name="twitter:creator" content="@NewOnMDN">

  <link rel="search" type="application/opensearchdescription+xml" href="https://developer.mozilla.org/en-US/search/xml" title="Mozilla Developer Network">

  <!-- third-generation iPad with high-resolution Retina display: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../../../../../developer.cdn.mozilla.net/media/redesign/img/favicon144.png">
  <!-- iPhone with high-resolution Retina display: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../../../../../../developer.cdn.mozilla.net/media/redesign/img/favicon114.png">
  <!-- first- and second-generation iPad: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../../../../../../developer.cdn.mozilla.net/media/redesign/img/favicon72.png">
  <!-- non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="../../../../../../../../developer.cdn.mozilla.net/media/redesign/img/favicon57.png">
  <!-- basic favicon -->
          <link rel="shortcut icon" href="../../../../../../../../developer.cdn.mozilla.net/media/redesign/img/favicon32.png">
  <!--[if IE]>
  <meta http-equiv="imagetoolbar" content="no">
  <script src="https://developer.cdn.mozilla.net/media/js/libs/html5.js"></script>
  <![endif]-->

    <link rel="alternate" type="application/json" href="nsIMessenger%24json.json">
  <link rel="canonical" href="nsIMessenger.html" >

  
  <!-- document-specific social tags -->
  <meta property="og:title" content="nsIMessenger">
  <meta property="og:url" content="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger">
  <meta name="twitter:url" content="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger">
  <meta name="twitter:title" content="nsIMessenger">
    <meta property="og:description" content="The nsIMessenger interface provides functions for managing the history, undo and redo operations, and for loading, saving, or deleting messages and attachments in mailnews.">
  <meta name="description" content="The nsIMessenger interface provides functions for managing the history, undo and redo operations, and for loading, saving, or deleting messages and attachments in mailnews.">
  <meta name="twitter:description" content="The nsIMessenger interface provides functions for managing the history, undo and redo operations, and for loading, saving, or deleting messages and attachments in mailnews.">
  
      <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','../../../../../../../../www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-36116321-5', 'mozilla.org');
    ga('set', 'anonymizeIp', true);

    
    
    
    (function() {
        // http://cfsimplicity.com/61/removing-analytics-clutter-from-campaign-urls
        var win = window;
        var removeUtms = function(){
            var location = win.location;
            if (location.hash.indexOf('utm') != -1) {
                var anchor = location.hash.match(/#(?!utm)[^&]+/);
                anchor = anchor ? anchor[0] : '';
                if(!anchor && win.history.replaceState){
                    history.replaceState({}, '', location.pathname + location.search);
                } else {
                    location.hash = anchor;
                }
            }
        };

        ga('send', 'pageview', removeUtms(win.location + ''));
    })();
</script>
  <script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"VgAEV1RTGwABU1NSAAQ="};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o?o:e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e){function n(t,e,n){n||(n={});for(var r=o[t],a=r&&r.length||0,s=n[i]||(n[i]={}),u=0;a>u;u++)r[u].apply(s,e);return s}function r(t,e){var n=o[t]||(o[t]=[]);n.push(e)}var o={},i="nr@context";e.exports={on:r,emit:n}},{}],2:[function(t){function e(t,e,n,i,s){return u?u-=1:r("err",[s||new UncaughtException(t,e,n)]),"function"==typeof a?a.apply(this,o(arguments)):!1}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function n(t){r("err",[t,(new Date).getTime()])}var r=t("handle"),o=t(6),i=t(5),a=window.onerror,s=!1,u=0;t("loader").features.push("err"),window.onerror=e,NREUM.noticeError=n;try{throw new Error}catch(d){"stack"in d&&(t(1),t(2),"addEventListener"in window&&t(3),window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&t(4),s=!0)}i.on("fn-start",function(){s&&(u+=1)}),i.on("fn-err",function(t,e,r){s&&(this.thrown=!0,n(r))}),i.on("fn-end",function(){s&&!this.thrown&&u>0&&(u-=1)}),i.on("internal-error",function(t){r("ierr",[t,(new Date).getTime(),!0])})},{1:5,2:4,3:3,4:6,5:1,6:14,handle:"D5DuLP",loader:"G9z0Bl"}],3:[function(t){function e(t){r.inPlace(t,["addEventListener","removeEventListener"],"-",n)}function n(t){return t[1]}var r=t(1),o=(t(3),t(2));if(e(window),"getPrototypeOf"in Object){for(var i=document;i&&!i.hasOwnProperty("addEventListener");)i=Object.getPrototypeOf(i);i&&e(i);for(var a=XMLHttpRequest.prototype;a&&!a.hasOwnProperty("addEventListener");)a=Object.getPrototypeOf(a);a&&e(a)}else XMLHttpRequest.prototype.hasOwnProperty("addEventListener")&&e(XMLHttpRequest.prototype);o.on("addEventListener-start",function(t){if(t[1]){var e=t[1];"function"==typeof e?this.wrapped=e["nr@wrapped"]?t[1]=e["nr@wrapped"]:e["nr@wrapped"]=t[1]=r(e,"fn-"):"function"==typeof e.handleEvent&&r.inPlace(e,["handleEvent"],"fn-")}}),o.on("removeEventListener-start",function(t){var e=this.wrapped;e&&(t[1]=e)})},{1:15,2:1,3:14}],4:[function(t){var e=(t(3),t(1)),n=t(2);e.inPlace(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame"],"raf-"),n.on("raf-start",function(t){t[0]=e(t[0],"fn-")})},{1:15,2:1,3:14}],5:[function(t){function e(t){var e=t[0];"string"==typeof e&&(e=new Function(e)),t[0]=n(e,"fn-")}var n=(t(3),t(1)),r=t(2);n.inPlace(window,["setTimeout","setInterval","setImmediate"],"setTimer-"),r.on("setTimer-start",e)},{1:15,2:1,3:14}],6:[function(t){function e(){o.inPlace(this,s,"fn-")}function n(t,e){o.inPlace(e,["onreadystatechange"],"fn-")}function r(t,e){return e}var o=t(1),i=t(2),a=window.XMLHttpRequest,s=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"];window.XMLHttpRequest=function(t){var n=new a(t);try{i.emit("new-xhr",[],n),o.inPlace(n,["addEventListener","removeEventListener"],"-",function(t,e){return e}),n.addEventListener("readystatechange",e,!1)}catch(r){try{i.emit("internal-error",r)}catch(s){}}return n},window.XMLHttpRequest.prototype=a.prototype,o.inPlace(XMLHttpRequest.prototype,["open","send"],"-xhr-",r),i.on("send-xhr-start",n),i.on("open-xhr-start",n)},{1:15,2:1}],7:[function(t){function e(){function e(t){if("string"==typeof t&&t.length)return t.length;if("object"!=typeof t)return void 0;if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if("undefined"!=typeof FormData&&t instanceof FormData)return void 0;try{return JSON.stringify(t).length}catch(e){return void 0}}function n(t){var n=this.params,r=this.metrics;if(!this.ended){this.ended=!0;for(var i=0;u>i;i++)t.removeEventListener(s[i],this.listener,!1);if(!n.aborted){if(r.duration=(new Date).getTime()-this.startTime,4===t.readyState){n.status=t.status;var a=t.responseType,d="arraybuffer"===a||"blob"===a||"json"===a?t.response:t.responseText,f=e(d);if(f&&(r.rxSize=f),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;r.cbTime=this.cbTime,o("xhr",[n,r])}}}function r(t,e){var n=i(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}t("loader").features.push("xhr");var o=t("handle"),i=t(1),a=t(5),s=["load","error","abort","timeout"],u=s.length,d=t(2);t(3),t(4),a.on("new-xhr",function(){this.totalCbs=0,this.called=0,this.cbTime=0,this.end=n,this.ended=!1,this.xhrGuids={}}),a.on("open-xhr-start",function(t){this.params={method:t[0]},r(this,t[1]),this.metrics={}}),a.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),a.on("send-xhr-start",function(t,n){var r=this.metrics,o=t[0],i=this;if(r&&o){var d=e(o);d&&(r.txSize=d)}this.startTime=(new Date).getTime(),this.listener=function(t){try{"abort"===t.type&&(i.params.aborted=!0),("load"!==t.type||i.called===i.totalCbs&&(i.onloadCalled||"function"!=typeof n.onload))&&i.end(n)}catch(e){try{a.emit("internal-error",e)}catch(r){}}};for(var f=0;u>f;f++)n.addEventListener(s[f],this.listener,!1)}),a.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),a.on("xhr-load-added",function(t,e){var n=""+d(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),a.on("xhr-load-removed",function(t,e){var n=""+d(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),a.on("addEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-added",[t[1],t[2]],e)}),a.on("removeEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-removed",[t[1],t[2]],e)}),a.on("fn-start",function(t,e,n){e instanceof XMLHttpRequest&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=(new Date).getTime()))}),a.on("fn-end",function(t,e){this.xhrCbStart&&a.emit("xhr-cb-time",[(new Date).getTime()-this.xhrCbStart,this.onload,e],e)})}window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)&&e()},{1:8,2:11,3:3,4:6,5:1,handle:"D5DuLP",loader:"G9z0Bl"}],8:[function(t,e){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");return!r.port&&o[1]&&(r.port=o[1].split("https://developer.mozilla.org/")[0].split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname),r.sameOrigin=!e.hostname||e.hostname===document.domain&&e.port===n.port&&e.protocol===n.protocol,r}},{}],handle:[function(t,e){e.exports=t("D5DuLP")},{}],D5DuLP:[function(t,e){function n(t,e){var n=r[t];return n?n.apply(this,e):(o[t]||(o[t]=[]),void o[t].push(e))}var r={},o={};e.exports=n,n.queues=o,n.handlers=r},{}],11:[function(t,e){function n(t){if(!t||"object"!=typeof t&&"function"!=typeof t)return-1;if(t===window)return 0;if(o.call(t,"__nr"))return t.__nr;try{return Object.defineProperty(t,"__nr",{value:r,writable:!0,enumerable:!1}),r}catch(e){return t.__nr=r,r}finally{r+=1}}var r=1,o=Object.prototype.hasOwnProperty;e.exports=n},{}],loader:[function(t,e){e.exports=t("G9z0Bl")},{}],G9z0Bl:[function(t,e){function n(){var t=p.info=NREUM.info;if(t&&t.agent&&t.licenseKey&&t.applicationID&&u&&u.body){p.proto="https"===c.split(":")[0]||t.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var e=u.createElement("script");e.src=p.proto+t.agent,u.body.appendChild(e)}}function r(){"complete"===u.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=t("handle"),s=window,u=s.document,d="addEventListener",f="attachEvent",c=(""+location).split("?")[0],p=e.exports={offset:i(),origin:c,features:[]};u[d]?(u[d]("DOMContentLoaded",o,!1),s[d]("load",n,!1)):(u[f]("onreadystatechange",r),s[f]("onload",n)),a("mark",["firstbyte",i()])},{handle:"D5DuLP"}],14:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(0>o?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=n},{}],15:[function(t,e){function n(t,e,r,s){function nrWrapper(){try{var n,a=u(arguments),d=this,f=r&&r(a,d)||{}}catch(c){i([c,"",[a,d,s],f])}o(e+"start",[a,d,s],f);try{return n=t.apply(d,a)}catch(p){throw o(e+"err",[a,d,p],f),p}finally{o(e+"end",[a,d,n],f)}}return a(t)?t:(e||(e=""),nrWrapper[n.flag]=!0,nrWrapper)}function r(t,e,r,o){r||(r="");var i,s,u,d="-"===r.charAt(0);for(u=0;u<e.length;u++)s=e[u],i=t[s],a(i)||(t[s]=n(i,d?s+r:r,o,s,t))}function o(t,e,n){try{s.emit(t,e,n)}catch(r){i([r,t,e,n])}}function i(t){try{s.emit("internal-error",t)}catch(e){}}function a(t){return!(t&&"function"==typeof t&&t.apply&&!t[n.flag])}var s=t(1),u=t(2);e.exports=n,n.inPlace=r,n.flag="nr@wrapper"},{1:1,2:14}]},{},["G9z0Bl",2,7]);</script></head>
<body data-slug="Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger" contextmenu="edit-history-menu" class="document  ">

  <script type="text/javascript">
    (function(win) {
        'use strict';

                    (function(){
  var FLAGS = {
    'derby_closed': true,'ga_outbound_links': true,'kumaediting': false,'page_move': false,'promote_script': false,'redirect_messages': false,'top_contributors': false,'wiki_spellcheck': false
    },
    SWITCHES = {
    'wiki_error_on_delete': false,'wiki_force_immediate_rendering': false,'render_stale_documents_async': true,'enable_optimizely': false
    },
    SAMPLES = {
    
    };
  window.waffle = {
    "flag_is_active": function waffle_flag(flag_name) {
      
      return !!FLAGS[flag_name];
    },
    "switch_is_active": function waffle_switch(switch_name) {
      
      return !!SWITCHES[switch_name];
    },
    "sample_is_active": function waffle_sample(sample_name) {
      
      return !!SAMPLES[sample_name];
    },
    "FLAGS": FLAGS,
    "SWITCHES": SWITCHES,
    "SAMPLES": SAMPLES
  };
})();

                
        // This represents the site configuration
        win.mdn = {
            build: '9fd3034',
            // Properties and settings for CKEditor will go here
            ckeditor: {},
            // Feature test results and methods will be placed here
            features: {},
            // The path to media (images, CSS, JS) in MDN
            mediaPath: 'https://developer.cdn.mozilla.net/media/',
            // Optimizely API
            optimizely: win['optimizely'] || [],
            // Site notifications
            notifications: [],
            
            // Wiki-specific settings will be placed here
            wiki: {
                autosuggestTitleUrl: '/en-US/docs/get-documents'
            },
        };

        // Ensures gettext always returns something, is always set
        win.gettext = function(x) {
            return x;
        }
    })(window);
</script>
  

  
  <ul id="nav-access">
    <li><a href="#document-main" id="skip-main">Skip to main content</a></li>
    <li><a id="skip-language" href="#language">Select language</a></li>
          <li><a href="#q" id="skip-search">Skip to search</a></li>
      </ul>

  <!-- Header -->
  <header id="main-header"><div class="center">

    <div class="clear header-login">
      <a href="http://www.mozilla.org/" id="tabzilla" class="no-track">mozilla</a>
                <script src="../../../../../../../../login.persona.org/include.js"></script>
<script type="text/javascript">
(function() {
  var allauth = window.allauth = window.allauth || {};

  function startWatching() {
    navigator.id.watch({
      onlogin: function(assertion) {
        // TODO: next url handling
        document.getElementById("_persona_assertion").value = assertion;
        document.getElementById("_persona_login").submit();
      },
      onlogout: function() {
        // TODO
      }
    })
  };

  allauth.persona = {
    login: function(nextUrl, process) {
        document.getElementById("_persona_next_url").value = nextUrl || '';
        document.getElementById("_persona_process").value = process;
        startWatching();
        navigator.id.request({"siteName": "Mozilla Developer Network", "siteLogo": "/media/redesign/img/opengraph-logo.png"});
    }
  }
})();
</script>

<form id="_persona_login" method="post" action="https://developer.mozilla.org/users/persona/login/">
  <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='OFUZvWX3cvltHNznKujHNL8vtsBRoNMa' /></div>
  <input type="hidden" name="next" value="" id="_persona_next_url"/>
  <input type="hidden" name="process" value="" id="_persona_process"/>
  <input type="hidden" name="assertion" id="_persona_assertion"/>
</form>

  <form>
      <div class="oauth-login-container" tabIndex="0">
          <div class="oauth-login-options">
              <span>Sign in with</span>
              <span class="oauth-icon oauth-persona" title="Sign in with Persona"><i class="icon-user" aria-hidden="true"></i></span>
                      </div>
          <div class="submenu oauth-login-picker" aria-hidden="true">
              <ul>
                  <li><a href="javascript:allauth.persona.login('/en\u002DUS/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger', 'login')" class="persona-button persona-loaded login-link" data-next="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger" data-service="Persona"><i class="icon-user" aria-hidden="true"></i>Persona</a></li>
                              </ul>
          </div>
      </div>
  </form>
          </div>

    <a href="https://developer.mozilla.org/en-US/" class="logo">Mozilla Developer Network</a>

    <nav id="main-nav" role="navigation"><ul><li><a href="https://developer.mozilla.org/en-US/docs/Zones">Zones<i aria-hidden="true" class="icon-caret-down"></i></a>

        <div class="submenu submenu-single" id="nav-zones-submenu">
          <div class="submenu-column">
            <ul>
              <li><a href="https://developer.mozilla.org/en-US/Add-ons">Add-ons</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Apps">App Center</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Firefox">Firefox</a></li>
              <li><a href="https://developer.mozilla.org/en-US/Marketplace">Firefox Marketplace</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Firefox_OS">Firefox OS</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Persona">Persona</a></li>
            </ul>
          </div>
        </div>
      </li><li><a href="https://developer.mozilla.org/en-US/docs/Web">Web Platform<i aria-hidden="true" class="icon-caret-down"></i></a>

        <div class="submenu" id="nav-platform-submenu">
          <div class="submenu-column">
            <div class="title">Technologies</div>
            <ul>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML">HTML</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS">CSS</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Graphics">Graphics</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/API">APIs / DOM</a></li>
              <li><a href="https://developer.mozilla.org/en-US/Apps">Apps</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/MathML">MathML</a></li>
            </ul>
          </div><div class="submenu-column last">
            <div class="title">References & Guides</div>
            <ul>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/Tutorials">Tutorials</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/Reference">References</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide">Developer Guides</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility">Accessibility</a></li>
              <li><a href="https://developer.mozilla.org/en-US/demos/">Demos</a></li>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web">...more docs</a></li>
            </ul>
          </div>
        </div>
      </li><li><a href="https://developer.mozilla.org/en-US/docs/Tools">Tools</a></li><li><a href="https://developer.mozilla.org/en-US/demos/">Demos</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Connect">Connect</a></li><li class="main-nav-search"><form action="https://developer.mozilla.org/en-US/search" method="get" role="search">
        <div class="search-wrap">
          <label for="main-q" class="offscreen">Search</label>
          <input type="search" id="main-q" name="q" data-placeholder="Search" data-value="" value="" />
          <span class="search-trigger"><i aria-hidden="true" class="icon-search"></i></span>&nbsp;
          <button type="submit" class="offscreen">Search</button>
        </div>
      </form></li></ul></nav>
  </div></header>

  <!-- Content will go here -->
  <main id="content"><div class="center clear">
  
   <!-- end is_zone -->


    <div class="wiki-main-content" id="document-main"><div class="center">
            <div class="article-meta">
        <!-- action buttons -->
        
        
        

  <ul class="page-buttons" data-sticky="false"><li><button id="languages-menu" class="transparent" aria-haspopup="true" aria-owns="languages-menu-submenu" aria-expanded="false"><span>Languages</span><i aria-hidden="true" class="icon-globe"></i></button>

        <div class="submenu" id="languages-menu-submenu">
          <div class="submenu-column">
            <ul id="translations">
                              <li class="smaller">No translations exist for this document.</li>
              
                              <li><a href="https://developer.mozilla.org/en-US/users/signin/?next=/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger%24locales">Add a translation</a></li>
                          </ul>
          </div>
        </div></li><li class="page-buttons-edit"><a href="https://developer.mozilla.org/en-US/users/signin/?next=/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger%24edit" class="button" data-optimizely-hook="button-edit-doc" id="edit-button">Edit<i aria-hidden="true" class="icon-pencil"></i></a></li><li><button id="advanced-menu" class="only-icon" aria-haspopup="true" aria-owns="advanced-menu-submenu" aria-expanded="false"><span>Advanced</span><i aria-hidden="true" class="icon-cog"></i></button>

        <div class="submenu" id="advanced-menu-submenu">
          <!-- this page -->
          <div class="submenu-column">
            <div class="title">Advanced</div>
            <ul>
                <li><a href="nsIMessenger%24history.html">History</a></li>
                                                                
                
                                
                                                                <li class="page-print"><a href="#" onclick="return window.print();"  title="Print page">Print this page</a></li>
            </ul>
          </div>
        </div>
  </li></ul>

        <!-- crumbs -->
          <nav class="crumbs" role="navigation"><ol xmlns:v="http://rdf.data-vocabulary.org/#" aria-label="breadcrumbs">
    <li typeof="v:Breadcrumb"><a href="https://developer.mozilla.org/en-US" rel="v:url" property="v:title">MDN</a></li>
          <li class="crumb" typeof="v:Breadcrumb"><a href="https://developer.mozilla.org/en-US/docs/Mozilla" rel="v:url" property="v:title">Mozilla</a></li>
          <li class="crumb" typeof="v:Breadcrumb"><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech" rel="v:url" property="v:title">Mozilla technologies</a></li>
          <li class="crumb" typeof="v:Breadcrumb"><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM" rel="v:url" property="v:title">XPCOM</a></li>
          <li class="crumb" typeof="v:Breadcrumb"><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference" rel="v:url" property="v:title">XPCOM reference</a></li>
          <li class="crumb" typeof="v:Breadcrumb"><a href="../Interface.html" rel="v:url" property="v:title">XPCOM Interface Reference</a></li>
        <li class="crumb" typeof="v:Breadcrumb" property="v:title">nsIMessenger</li>
  </ol></nav>
      </div>

      <!-- heading -->
      <div id="wiki-document-head" class="document-head">
          <span class="from-search-previous-box">
            <a class="button from-search-previous only-icon disabled" title="Previous Search Result" data-empty-title="No Previous Search Result"><i aria-hidden="true" class="icon-chevron-left"></i></a>
          </span>
          <span class="from-search-navigate-wrap">
            <a href="#" class="from-search-navigate"><span class="from-search-navigate-up"><i aria-hidden="true" class="icon-double-angle-up"></i></span><span class="from-search-navigate-down"><i aria-hidden="true" class="icon-double-angle-down"></i></span></a>
          </span>
          <div class="from-search-toc">
            <span class="title">Your Search Results</span>
            <ol></ol>
          </div>
          <span class="from-search-next-box">
            <a class="button from-search-next only-icon disabled" title="Next Search Result" data-empty-title="No Previous Search Result"><i aria-hidden="true" class="icon-chevron-right"></i></a>
          </span>
        <h1>nsIMessenger</h1>
        
      </div>
      
      <!-- start the main content container -->
        <div id="wiki-column-container" class="wiki-right-present wiki-left-closed wiki-left-none">

          
          <!-- content row with three strips -->
          <div class="column-container column-container-reverse">

                          <!-- TOC, approvals, etc -->
              <div class="column-strip wiki-column" id="wiki-right">
                            <!-- table of contents -->
              <div id="toc" class="toc toggleable">
                <a href="#toc" class="title toggler" data-open-icon="icon-plus" data-closed-icon="icon-minus">In This Article<i></i></a>
                <ol class="toggle-container">
                  <code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#Method_overview" rel="internal">Method overview</a><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#Attributes" rel="internal">Attributes</a><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#Constants" rel="internal">Constants</a><code></code><code></code><code></code><code></code><li><a href="#Methods" rel="internal">Methods</a><ol><li><a href="#setDisplayCharset.28.29" rel="internal">setDisplayCharset()</a><code></code><li><a href="#setWindow.28.29" rel="internal">setWindow()</a><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#openURL.28.29" rel="internal">openURL()</a><code></code><code></code><li><a href="#loadURL.28.29" rel="internal">loadURL()</a><code></code><code></code><code></code><li><a href="#launchExternalURL.28.29" rel="internal">launchExternalURL()</a><code></code><li><a href="#canUndo.28.29" rel="internal">canUndo()</a><li><a href="#canRedo.28.29" rel="internal">canRedo()</a><li><a href="#getUndoTransactionType.28.29" rel="internal">getUndoTransactionType()</a><li><a href="#getRedoTransactionType.28.29" rel="internal">getRedoTransactionType()</a><code></code><li><a href="#undo.28.29" rel="internal">undo()</a><code></code><code></code><li><a href="#redo.28.29" rel="internal">redo()</a><code></code><code></code><li><a href="#sendUnsentMessages.28.29" rel="internal">sendUnsentMessages()</a><code></code><code></code><code></code><code></code><code></code><li><a href="#setDocumentCharset.28.29" rel="internal">setDocumentCharset()</a><code></code><li><a href="#saveAs.28.29" rel="internal">saveAs()</a><code></code><code></code><code></code><code></code><li><a href="#openAttachment.28.29" rel="internal">openAttachment()</a><code></code><code></code><code></code><code></code><code></code><li><a href="#saveAttachment.28.29" rel="internal">saveAttachment()</a><code></code><code></code><code></code><code></code><code></code><li><a href="#saveAllAttachments.28.29" rel="internal">saveAllAttachments()</a><code></code><code></code><code></code><code></code><code></code><li><a href="#saveAttachmentToFile.28.29" rel="internal">saveAttachmentToFile()</a><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#detachAttachment.28.29" rel="internal">detachAttachment()</a><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#detachAllAttachments.28.29" rel="internal">detachAllAttachments()</a><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#saveAttachmentToFolder.28.29" rel="internal">saveAttachmentToFolder()</a><code></code><code></code><code></code><code></code><code></code><code></code><code></code><code></code><li><a href="#messageServiceFromURI.28.29" rel="internal">messageServiceFromURI()</a><code></code><code></code><code></code><li><a href="#msgHdrFromURI.28.29" rel="internal">msgHdrFromURI()</a><li><a href="#getMsgUriAtNavigatePos.28.29" rel="internal">getMsgUriAtNavigatePos()</a><code></code><li><a href="#getFolderUriAtNavigatePos.28.29" rel="internal">getFolderUriAtNavigatePos()</a><code></code><li><a href="#getNavigateHistory.28.29" rel="internal">getNavigateHistory()</a><code></code><code></code><code></code><code></code></ol></li>
                </ol>
              </div>
                            </div>
            
                                                  
            <!-- center: main article content -->
            <div id="wiki-content" class="column-main wiki-column text-content">

              
              
                                                                                          
              <!-- just the article content -->
              <article id="wikiArticle">
                                                      <p>The <code>nsIMessenger</code> interface provides functions for managing the history, undo and redo operations, and for loading, saving, or deleting messages and attachments in mailnews.</p>
<p><code><span class="script">web.html($0)</span></code> is defined in 
 <span class="script">wiki.template('tbsource', mediawiki.args([$1]))</span>. 
 It is <span class="script">wiki.template(mediawiki.path('InterfaceStatus:Scriptable_' + $4, "en"))</span> 
 and <span class="script">wiki.template(mediawiki.path('InterfaceStatus:' + $2, "en"), mediawiki.args([$3]))</span>.</p>
<p>Inherits from: <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsISupports" title="">nsISupports</a></code></p>
<p>Implemented by: <code>@mozilla.org/messenger;1</code>. To create an instance, use:</p>
<pre class="eval"> messenger = Components.classes["@mozilla.org/messenger;1"]
                       .createInstance(Components.interfaces.nsIMessenger);
</pre>
<p>In <a href="https://developer.mozilla.org/en/Thunderbird" title="en/Thunderbird">Thunderbird</a>, a global nsIMessenger object is defined as <code>messenger</code> via the <code>createMessenger</code> function in <a class="external" href="../../../../../../../../mxr.mozilla.org/mozilla/source/mail/base/content/mailWindow.html#112">mailWindow.js</a>.</p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#setDisplayCharset.28.29">setDisplayCharset</a>(in ACString aCharset);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setWindow.28.29">setWindow</a>(in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIDOMWindowInternal" title="en/XPCOM_Interface_Reference/nsIDOMWindowInternal">nsIDOMWindow</a> ptr, in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgWindow" title="en/XPCOM_Interface_Reference/nsIMsgWindow">nsIMsgWindow</a> msgWindow);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#openURL.28.29">openURL</a>(in ACString aURL);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#loadURL.28.29">loadURL</a>(in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIDOMWindowInternal" title="en/XPCOM_Interface_Reference/nsIDOMWindowInternal">nsIDOMWindow</a> ptr, in ACString aURL);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#launchExternalURL.28.29">launchExternalURL</a>(in ACString aURL);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#canUndo.28.29">canUndo</a>();</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#canRedo.28.29">canRedo</a>();</code></td>
  </tr>
  <tr>
   <td><code>unsigned long <a href="#getUndoTransactionType.28.29">getUndoTransactionType</a>();</code></td>
  </tr>
  <tr>
   <td><code>unsigned long <a href="#getRedoTransactionType.28.29">getRedoTransactionType</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#undo.28.29">undo</a>(in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgWindow" title="en/XPCOM_Interface_Reference/nsIMsgWindow">nsIMsgWindow</a> msgWindow);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#redo.28.29">redo</a>(in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgWindow" title="en/XPCOM_Interface_Reference/nsIMsgWindow">nsIMsgWindow</a> msgWindow);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#sendUnsentMessages.28.29">sendUnsentMessages</a>(in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgIdentity" title="en/XPCOM_Interface_Reference/nsIMsgIdentity">nsIMsgIdentity</a> aIdentity, in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgWindow" title="en/XPCOM_Interface_Reference/nsIMsgWindow">nsIMsgWindow</a> aMsgWindow);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setDocumentCharset.28.29">setDocumentCharset</a>(in ACString characterSet);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#saveAs.28.29">saveAs</a>(in ACString aURI, in boolean aAsFile, in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgIdentity" title="en/XPCOM_Interface_Reference/nsIMsgIdentity">nsIMsgIdentity</a> aIdentity, in AString aMsgFilename);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#openAttachment.28.29">openAttachment</a>(in ACString contentTpe, in ACString url, in ACString displayName, in ACString messageUri, in boolean isExternalAttachment);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#saveAttachment.28.29">saveAttachment</a>(in ACString contentTpe, in ACString url, in ACString displayName, in ACString messageUri, in boolean isExternalAttachment);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#saveAllAttachments.28.29">saveAllAttachments</a>(in unsigned long count, [array, size_is(count)] in string contentTypeArray, [array, size_is(count)] in string urlArray, [array, size_is(count)] in string displayNameArray, [array, size_is(count)] in string messageUriArray);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#saveAttachmentToFile.28.29">saveAttachmentToFile</a>(in <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIFile" title="en/XPCOM_Interface_Reference/nsIFile">nsIFile</a> aFile, in ACString aUrl, in ACString aMessageUri, in ACString aContentType, in <a href="https://developer.mozilla.org/en/NsIUrlListener" title="en/NsIUrlListener">nsIUrlListener</a> aListener);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#detachAttachment.28.29">detachAttachment</a>(in string contentTpe, in string url, in string displayName, in string messageUri, in boolean saveFirst, [optional] in boolean withoutWarning);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#detachAllAttachments.28.29">detachAllAttachments</a>(in unsigned long count, [array, size_is(count)] in string contentTypeArray, [array, size_is(count)] in string urlArray, [array, size_is(count)] in string displayNameArray, [array, size_is(count)] in string messageUriArray, in boolean saveFirst, [optional] in boolean withoutWarning);</code></td>
  </tr>
  <tr>
   <td><code><a href="https://developer.mozilla.org/en/NsILocalFile" title="en/NsILocalFile">nsILocalFile</a> <a href="#saveAttachmentToFolder.28.29">saveAttachmentToFolder</a>(in ACString contentType, in ACString url, in ACString displayName, in ACString messageUri, in <a href="https://developer.mozilla.org/en/NsILocalFile" title="en/NsILocalFile">nsILocalFile</a> aDestFolder);</code></td>
  </tr>
  <tr>
   <td><code><a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgMessageService" title="en/XPCOM_Interface_Reference/nsIMsgMessageService">nsIMsgMessageService</a> <a href="#messageServiceFromURI.28.29">messageServiceFromURI</a>(in ACString aUri);</code></td>
  </tr>
  <tr>
   <td><code><a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgDBHdr" title="en/XPCOM_Interface_Reference/nsIMsgDBHdr">nsIMsgDBHdr</a> <a href="#msgHdrFromURI.28.29">msgHdrFromURI</a>(in ACString aUri);</code></td>
  </tr>
  <tr>
   <td><code>ACString <a href="#getMsgUriAtNavigatePos.28.29">getMsgUriAtNavigatePos</a>(in long aPos);</code></td>
  </tr>
  <tr>
   <td><code>ACString <a href="#getFolderUriAtNavigatePos.28.29">getFolderUriAtNavigatePos</a>(in long aPos);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getNavigateHistory.28.29">getNavigateHistory</a>(out unsigned long aCurPos, out unsigned long aCount, [array, size_is(aCount)] out string aHistory);</code></td>
  </tr>
 </tbody>
</table>
<div class="note">
 <p><strong>Note:</strong> Prior to <span title="(Firefox 8.0 / Thunderbird 8.0 / SeaMonkey 2.5)">Gecko 8.0</span>, all references to <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIDOMWindow" title="">nsIDOMWindow</a></code> used in this interface were <code>nsIDOMWindow</code>.</p>
</div>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>transactionManager</code></td>
   <td><code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransactionManager" title="">nsITransactionManager</a></code></td>
   <td><strong>Readonly:</strong> The transaction manager for this <code>nsIMessenger</code> instance.</td>
  </tr>
  <tr>
   <td><code>sendingUnsentMsgs</code></td>
   <td>boolean</td>
   <td>Indicates if sending messages is in progress.</td>
  </tr>
  <tr>
   <td><code>lastDisplayedMessageUri</code></td>
   <td>ACString</td>
   <td><strong>Readonly:</strong> The URL of the last displayed message.</td>
  </tr>
  <tr>
   <td><code>navigatePos</code></td>
   <td>long</td>
   <td>The current index in the navigation history.</td>
  </tr>
 </tbody>
</table>
<h2 id="Constants" name="Constants">Constants</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Name</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>eUnknown</code></td>
   <td>0</td>
   <td>Unknown transaction type.</td>
  </tr>
  <tr>
   <td><code>eDeleteMsg</code></td>
   <td>1</td>
   <td>Delete transaction type.</td>
  </tr>
  <tr>
   <td><code>eMoveMsg</code></td>
   <td>2</td>
   <td>Move transaction type.</td>
  </tr>
  <tr>
   <td><code>eCopyMsg</code></td>
   <td>3</td>
   <td>Copy transaction type.</td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="setDisplayCharset.28.29" name="setDisplayCharset.28.29">setDisplayCharset()</h3>
<p>Sets the character set for the displayed message.</p>
<pre class="eval"> void setDisplayCharset(in ACString aCharset);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>aCharset</code></dt>
 <dd>
  The character set to use.</dd>
</dl>
<h3 id="setWindow.28.29" name="setWindow.28.29">setWindow()</h3>
<p>Sets the current window for a messenger session.</p>
<pre class="eval"> void setWindow(in nsIDOMWindow aWin,
                in nsIMsgWindow aMsgWindow);
</pre>
<h6 id="Parameters_2" name="Parameters_2">Parameters</h6>
<dl>
 <dt>
  <code>aWin</code></dt>
 <dd>
  The window to set as the window for the messaging session. If this window contains a messagepane element (I think this may mean a <a href="https://developer.mozilla.org/en/XUL/browser" title="en/XUL/browser">XUL:browser</a> element with its <code>id</code> set to "messagepane"?), then the <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIDocShell" title="">nsIDocShell</a></code> will be used for future <code>nsIMessenger</code> operations. If there is no messagepane element, then the root XUL <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIDocShell" title="">nsIDocShell</a></code> will be used (so that <code>openURL()</code> will still work). If <code>null</code> is passed in then observers are removed in preparation for shutdown.</dd>
 <dt>
  <code>aMsgWindow</code></dt>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgWindow" title="">nsIMsgWindow</a></code> with the transation manager to be used.</dd>
</dl>
<h3 id="openURL.28.29" name="openURL.28.29">openURL()</h3>
<p>Opens a url in the current window (set by <code>setWindow()</code>) and adds it to the current history.</p>
<pre class="eval"> void openURL(in ACString aURL);
</pre>
<h6 id="Parameters_3" name="Parameters_3">Parameters</h6>
<dl>
 <dt>
  <code>aURL</code></dt>
 <dd>
  The url to open.</dd>
</dl>
<h3 id="loadURL.28.29" name="loadURL.28.29">loadURL()</h3>
<p>Load a custom message by url. Similar to <code>openURL()</code> except can be used to load things that appear as messages to users (e.g load an attachment as a email).</p>
<pre class="eval"> void loadURL(in nsIDOMWindow aWin,
              in ACString aURL); 
</pre>
<h6 id="Parameters_4" name="Parameters_4">Parameters</h6>
<dl>
 <dt>
  <code>aWin</code></dt>
 <dd>
  A window. As far as I can tell this isn't used or checked.</dd>
 <dt>
  <code>aURL</code></dt>
 <dd>
  The url to open.</dd>
</dl>
<h3 id="launchExternalURL.28.29" name="launchExternalURL.28.29">launchExternalURL()</h3>
<p>Launches the <a href="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIExternalProtocolService" title="en/XPCOM_Interface_Reference/nsIExternalProtocolService">nsIExternalProtocolService</a> and sends it the url.</p>
<pre class="eval"> void launchExternalURL(in ACString aURL);
</pre>
<h6 id="Parameters_5" name="Parameters_5">Parameters</h6>
<dl>
 <dt>
  <code>aURL</code></dt>
 <dd>
  The url to open.</dd>
</dl>
<h3 id="canUndo.28.29" name="canUndo.28.29">canUndo()</h3>
<p>Queries if there are any undo items in the transaction manager.</p>
<pre class="eval"> boolean canUndo();
</pre>
<h6 id="Return_value" name="Return_value">Return value</h6>
<dl>
 <dd>
  Boolean representing whether undo is available.</dd>
</dl>
<h3 id="canRedo.28.29" name="canRedo.28.29">canRedo()</h3>
<p>Queries if there are any redo items in the transaction manager.</p>
<pre class="eval"> boolean canRedo();
</pre>
<h6 id="Return_value_2" name="Return_value_2">Return value</h6>
<dl>
 <dd>
  Boolean representing whether redo is available.</dd>
</dl>
<h3 id="getUndoTransactionType.28.29" name="getUndoTransactionType.28.29">getUndoTransactionType()</h3>
<p>Gets the type of the next undo transaction.</p>
<pre class="eval"> unsigned long getUndoTransactionType();
</pre>
<h6 id="Return_value_3" name="Return_value_3">Return value</h6>
<dl>
 <dd>
  A long representing the type of the transaction. See <a href="#Constants">#Constants</a> for available types.</dd>
</dl>
<h3 id="getRedoTransactionType.28.29" name="getRedoTransactionType.28.29">getRedoTransactionType()</h3>
<p>Gets the type of the next redo transaction. Available types are defined as constants in <code>nsIMessenger</code>.</p>
<pre class="eval"> unsigned long getRedoTransactionType();
</pre>
<h6 id="Return_value_4" name="Return_value_4">Return value</h6>
<dl>
 <dd>
  A long representing the type of the transaction. See <a href="#Constants">#Constants</a> for available types.</dd>
</dl>
<h3 id="undo.28.29" name="undo.28.29">undo()</h3>
<p>Performs the next undo transaction.</p>
<pre class="eval"> void undo(in nsIMsgWindow msgWindow);
</pre>
<h6 id="Parameters_6" name="Parameters_6">Parameters</h6>
<dl>
 <dt>
  <code>msgWindow</code></dt>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgWindow" title="">nsIMsgWindow</a></code> to perform the undo transaction on.</dd>
</dl>
<h3 id="redo.28.29" name="redo.28.29">redo()</h3>
<p>Performs the next redo transaction.</p>
<pre class="eval"> void redo(in nsIMsgWindow msgWindow);
</pre>
<h6 id="Parameters_7" name="Parameters_7">Parameters</h6>
<dl>
 <dt>
  <code>msgWindow</code></dt>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgWindow" title="">nsIMsgWindow</a></code> to perform the redo transaction on.</dd>
</dl>
<h3 id="sendUnsentMessages.28.29" name="sendUnsentMessages.28.29">sendUnsentMessages()</h3>
<p>Creates a <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgSendLater" title="">nsIMsgSendLater</a></code> instance and sends all messages for the given identity.</p>
<pre class="eval"> void sendUnsentMessages(in nsIMsgIdentity aIdentity,
                         in nsIMsgWindow aMsgWindow);
</pre>
<h6 id="Parameters_8" name="Parameters_8">Parameters</h6>
<dl>
 <dt>
  <code>aIdentity</code></dt>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgIdentity" title="">nsIMsgIdentity</a></code> to send messages for.</dd>
 <dt>
  <code>aMsgWindow</code></dt>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgWindow" title="">nsIMsgWindow</a></code> to get messages from.</dd>
</dl>
<h3 id="setDocumentCharset.28.29" name="setDocumentCharset.28.29">setDocumentCharset()</h3>
<p>Redisplay the currently selected message (if any) using the given character set.</p>
<pre class="eval"> void setDocumentCharset(in ACString characterSet);
</pre>
<h6 id="Parameters_9" name="Parameters_9">Parameters</h6>
<dl>
 <dt>
  <code>characterSet</code></dt>
 <dd>
  The character set to use.</dd>
</dl>
<h3 id="saveAs.28.29" name="saveAs.28.29">saveAs()</h3>
<p>Save the URL given.</p>
<pre class="eval"> void saveAs(in ACString aURI,
             in boolean aAsFile,
             in nsIMsgIdentity aIdentity,
             in AString aMsgFilename);
</pre>
<h6 id="Parameters_10" name="Parameters_10">Parameters</h6>
<dl>
 <dt>
  <code>aURI</code></dt>
 <dd>
  The URL of the message to save.</dd>
 <dt>
  <code>aAsFile</code></dt>
 <dd>
  If true a file picker is spawned with the option save the message as <a href="https://developer.mozilla.org/en/HTML" title="en/HTML">HTML</a>, text, or <a href="https://developer.mozilla.org/en/EML" title="en/EML">EML</a>. If false, the message is saved as a Template</dd>
 <dt>
  <code>aIdentity</code></dt>
 <dd>
  The identity to use if saving as a Template.</dd>
 <dt>
  <code>aMsgFilename</code></dt>
 <dd>
  The filename to use as the default filename if we are saving as a file.</dd>
</dl>
<h3 id="openAttachment.28.29" name="openAttachment.28.29">openAttachment()</h3>
<p>Open an attachment.</p>
<pre class="eval"> void openAttachment(in ACString contentType,
                     in ACString url,
                     in ACString displayName,
                     in ACString messageUri,
                     in boolean isExternalAttachment);
</pre>
<h6 id="Parameters_11" name="Parameters_11">Parameters</h6>
<dl>
 <dt>
  <code>contentType</code></dt>
 <dd>
  The content type of the attachment.</dd>
 <dt>
  <code>url</code></dt>
 <dd>
  The url of the attachment.</dd>
 <dt>
  <code>displayName</code></dt>
 <dd>
  The file name for display purposes.</dd>
 <dt>
  <code>messageUri</code></dt>
 <dd>
  The url of the message containing the attachment.</dd>
 <dt>
  <code>isExternalAttachment</code></dt>
 <dd>
  Is the attachment inside a message or saved somewhere externally. If set to true the attachment is opened inside the message pane which in turn should trigger the helper app dialog. Same as just using the <a href="#openURL.28.29">openURL()</a> method.</dd>
</dl>
<h3 id="saveAttachment.28.29" name="saveAttachment.28.29">saveAttachment()</h3>
<p>Save an attachment.</p>
<pre class="eval"> void saveAttachment(in ACString contentType,
                     in ACString url,
                     in ACString displayName,
                     in ACString messageUri,
                     in boolean isExternalAttachment);
</pre>
<h6 id="Parameters_12" name="Parameters_12">Parameters</h6>
<dl>
 <dt>
  <code>contentType</code></dt>
 <dd>
  The content type of the attachment.</dd>
 <dt>
  <code>url</code></dt>
 <dd>
  The url of the attachment.</dd>
 <dt>
  <code>displayName</code></dt>
 <dd>
  The file name for display purposes.</dd>
 <dt>
  <code>messageUri</code></dt>
 <dd>
  The url of the message containing the attachment.</dd>
 <dt>
  <code>isExternalAttachment</code></dt>
 <dd>
  Is the attachment inside a message or saved somewhere externally. If set to true the attachment is opened inside the message pane which in turn should trigger the helper app dialog. Same as just using the <a href="#openURL.28.29">openURL()</a> method.</dd>
</dl>
<h3 id="saveAllAttachments.28.29" name="saveAllAttachments.28.29">saveAllAttachments()</h3>
<p>Launches a filepicker and saves all attachments listed in an array.</p>
<pre class="eval"> void saveAllAttachments(in unsigned long count,
                         [array, size_is(count)] in string contentTypeArray,
                         [array, size_is(count)] in string urlArray,
                         [array, size_is(count)] in string displayNameArray,
                         [array, size_is(count)] in string messageUriArray);
</pre>
<h6 id="Parameters_13" name="Parameters_13">Parameters</h6>
<dl>
 <dt>
  <code>count</code></dt>
 <dd>
  The number of attachments being saved.</dd>
 <dt>
  <code>contentTypeArray</code></dt>
 <dd>
  An array of content types for each attachment.</dd>
 <dt>
  <code>urlArray</code></dt>
 <dd>
  An array of urls for each attachment.</dd>
 <dt>
  <code>displayNameArray</code></dt>
 <dd>
  An array of file names for each attachment.</dd>
 <dt>
  <code>messageUriArray</code></dt>
 <dd>
  An array of message uris for each attachment.</dd>
</dl>
<h3 id="saveAttachmentToFile.28.29" name="saveAttachmentToFile.28.29">saveAttachmentToFile()</h3>
<p>Save an attachment to a particular <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIFile" title="">nsIFile</a></code>.</p>
<pre class="eval"> void saveAttachmentToFile(in nsIFile aFile,
                           in ACString aUrl,
                           in ACString aMessageUri, 
                           in ACString aContentType,
                           in nsIUrlListener aListener);
</pre>
<h6 id="Parameters_14" name="Parameters_14">Parameters</h6>
<dl>
 <dt>
  <code>aFile</code></dt>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIFile" title="">nsIFile</a></code> to save to.</dd>
 <dt>
  <code>aUrl</code></dt>
 <dd>
  The url of the attachment.</dd>
 <dt>
  <code>aMessageUri</code></dt>
 <dd>
  The url of the message containing this attachment.</dd>
 <dt>
  <code>aContentType</code></dt>
 <dd>
  The content type of the attachment.</dd>
 <dt>
  <code>aListener</code></dt>
 <dd>
  An <code><a class="new" href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIUrlListener" title="">nsIUrlListener</a></code> to be notified when the file is saved.</dd>
</dl>
<h3 id="detachAttachment.28.29" name="detachAttachment.28.29">detachAttachment()</h3>
<p>Deletes an attachment from a message.</p>
<pre class="eval"> void detachAttachment(in string contentType,
                       in string url,
                       in string displayName,
                       in string messageUri,
                       in boolean saveFirst,
                       [optional] in boolean withoutWarning);
</pre>
<h6 id="Parameters_15" name="Parameters_15">Parameters</h6>
<dl>
 <dt>
  <code>contentType</code></dt>
 <dd>
  The content type of the attachment.</dd>
 <dt>
  <code>url</code></dt>
 <dd>
  The url of the attachment.</dd>
 <dt>
  <code>displayName</code></dt>
 <dd>
  The file name of the attachment.</dd>
 <dt>
  <code>messageUri</code></dt>
 <dd>
  The url of the message containing the attachment.</dd>
 <dt>
  <code>saveFirst</code></dt>
 <dd>
  If <code>true</code>, the attachment is saved using <a href="#saveAttachment.28.29">saveAttachment()</a> before it is deleted.</dd>
 <dt>
  <code>withoutWarning</code></dt>
 <dd>
  If <code>true</code>, no warning is shown to the user before the delete.</dd>
</dl>
<h3 id="detachAllAttachments.28.29" name="detachAllAttachments.28.29">detachAllAttachments()</h3>
<p>Deletes a set of attachments.</p>
<pre class="eval"> void detachAllAttachments(in unsigned long count,
                           [array, size_is(count)] in string contentTypeArray,
                           [array, size_is(count)] in string urlArray,
                           [array, size_is(count)] in string displayNameArray,
                           [array, size_is(count)] in string messageUriArray,
                           in boolean saveFirst,
                           [optional] in boolean withoutWarning);
</pre>
<h6 id="Parameters_16" name="Parameters_16">Parameters</h6>
<dl>
 <dt>
  <code>count</code></dt>
 <dd>
  The number of attachments to be deleted.</dd>
 <dt>
  <code>contentTypeArray</code></dt>
 <dd>
  An array of content types for each attachment.</dd>
 <dt>
  <code>urlArray</code></dt>
 <dd>
  An array of urls for each attachment.</dd>
 <dt>
  <code>displayNameArray</code></dt>
 <dd>
  An array of file names for each attachment.</dd>
 <dt>
  <code>messageUriArray</code></dt>
 <dd>
  An array of urls for the message containing each attachment.</dd>
 <dt>
  <code>saveFirst</code></dt>
 <dd>
  If <code>true</code>, the attachments are saved using <a href="#saveAllAttachments.28.29">saveAllAttachments()</a> before being deleted.</dd>
 <dt>
  <code>withoutWarning</code></dt>
 <dd>
  If <code>true</code>, no warning is shown to the user before the delete.</dd>
</dl>
<h3 id="saveAttachmentToFolder.28.29" name="saveAttachmentToFolder.28.29">saveAttachmentToFolder()</h3>
<p>Saves an attachment in a given folder. <code>saveAttachmentToFolder()</code> is used by the drag and drop code to drop an attachment to a destination folder. Returns the actual file path (including the filename).</p>
<pre class="eval"> nsILocalFile saveAttachmentToFolder(in ACString ,
                                     in ACString url,
                                     in ACString displayName,
                                     in ACString messageUri,
                                     in nsILocalFile aDestFolder);
</pre>
<h6 id="Parameters_17" name="Parameters_17">Parameters</h6>
<dl>
 <dt>
  <code>contentType</code></dt>
 <dd>
  The content type of the attachment.</dd>
 <dt>
  <code>url</code></dt>
 <dd>
  The url of the attachment.</dd>
 <dt>
  <code>displayName</code></dt>
 <dd>
  The file name of the attachment.</dd>
 <dt>
  <code>messageUri</code></dt>
 <dd>
  The url of the message containing the attachment.</dd>
 <dt>
  <code>aDestFolder</code></dt>
 <dd>
  An <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsILocalFile" title="">nsILocalFile</a></code> poiting to the folder where the attachment should be saved.</dd>
</dl>
<h6 id="Return_value_5" name="Return_value_5">Return value</h6>
<dl>
 <dd>
  The actual <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsILocalFile" title="">nsILocalFile</a></code> where the attachment was saved.</dd>
</dl>
<h3 id="messageServiceFromURI.28.29" name="messageServiceFromURI.28.29">messageServiceFromURI()</h3>
<p>Gets the <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgMessageService" title="">nsIMsgMessageService</a></code> in charge of a particular url. Message services are implemented for different protocols such as <a href="https://developer.mozilla.org/en/IMAP" title="en/IMAP">IMAP</a>, <a href="https://developer.mozilla.org/en/POP3" title="en/POP3">POP3</a>, or local mail sources.</p>
<pre class="eval"> nsIMsgMessageService messageServiceFromURI(in ACString aUri);
</pre>
<h6 id="Parameters_18" name="Parameters_18">Parameters</h6>
<dl>
 <dt>
  <code>aUri</code></dt>
 <dd>
  The url of the message or attachment to get the service for.</dd>
</dl>
<h6 id="Return_value_6" name="Return_value_6">Return value</h6>
<dl>
 <dd>
  The <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMsgMessageService" title="">nsIMsgMessageService</a></code> responsible for the url.</dd>
</dl>
<h3 id="msgHdrFromURI.28.29" name="msgHdrFromURI.28.29">msgHdrFromURI()</h3>
<pre class="eval"> nsIMsgDBHdr msgHdrFromURI(in ACString aUri);
</pre>
<h3 id="getMsgUriAtNavigatePos.28.29" name="getMsgUriAtNavigatePos.28.29">getMsgUriAtNavigatePos()</h3>
<p>Gets the message a particular position in the navigation history. For example, back-forward history needs a list of visited messages, and where it is in the list. Unfortunately, you must call this before navigating to a position, because calling this has the side effect of making us adjust our current history position, and <strong>not</strong> adding the loaded message to the history queue.</p>
<pre class="eval"> ACString getMsgUriAtNavigatePos(in long aPos);
</pre>
<h6 id="Parameters_19" name="Parameters_19">Parameters</h6>
<dl>
 <dt>
  <code>aPos</code></dt>
 <dd>
  The position to get the url from relative to the current history cursor. +1 is forward, -1 is back.</dd>
</dl>
<h6 id="Return_value_7" name="Return_value_7">Return value</h6>
<dl>
 <dd>
  The url at that point in the history.</dd>
</dl>
<h3 id="getFolderUriAtNavigatePos.28.29" name="getFolderUriAtNavigatePos.28.29">getFolderUriAtNavigatePos()</h3>
<p>Gets the folder url at a particular position in the navigation history.</p>
<pre class="eval"> ACString getFolderUriAtNavigatePos(in long aPos);
</pre>
<h6 id="Parameters_20" name="Parameters_20">Parameters</h6>
<dl>
 <dt>
  <code>aPos</code></dt>
 <dd>
  The position to get the url from relative to the current history cursor. +1 is forward, -1 is back.</dd>
</dl>
<h6 id="Return_value_8" name="Return_value_8">Return value</h6>
<dl>
 <dd>
  The url of the folder at that point in the history.</dd>
</dl>
<h3 id="getNavigateHistory.28.29" name="getNavigateHistory.28.29">getNavigateHistory()</h3>
<p>Returns information about the current navigation history. If caller just wants the count and current pos, they can pass in <code>null</code> for aHistory, which will be more efficent. If they want a list suitable for display, they should pass in an aHistory pointer, and they'll get returned an array with strings containing something like subject and sender of the message - other possible info is the folder containing the message, and the preview text, if available.</p>
<pre class="eval"> void getNavigateHistory(out unsigned long aCurPos, out unsigned long aCount, [array, size_is(aCount)] out string aHistory);
</pre>
<h6 id="Return_value_9" name="Return_value_9">Return value</h6>
<dl>
 <dt>
  <code>aCurPos</code></dt>
 <dd>
  The current position in the history.</dd>
 <dt>
  <code>aCount</code></dt>
 <dd>
  The number of items in the history.</dd>
 <dt>
  <code>aHistory</code></dt>
 <dd>
  An array of strings containing information about each entry in the history.</dd>
</dl>
                                                </article>

              
                <!-- attachments list -->
                
                <!-- contributors -->
                <div class="wiki-block contributors">
                  <h2 class="offscreen">Document Tags and Contributors</h2>
                                                      <!-- tags if present -->
                  <div class="tag-attach-list tags contributor-sub">
                    <i aria-hidden="true" class="icon-tags"></i><strong>Tags:</strong>
                    <ul class="tag-list"><li><a href="https://developer.mozilla.org/en-US/docs/tag/thunderbird">thunderbird</a></li><li><a href="https://developer.mozilla.org/en-US/docs/tag/NeedsContent">NeedsContent</a></li><li><a href="https://developer.mozilla.org/en-US/docs/tag/Interfaces">Interfaces</a></li><li><a href="https://developer.mozilla.org/en-US/docs/tag/XPCOM API Reference">XPCOM API Reference</a></li><li><a href="https://developer.mozilla.org/en-US/docs/tag/XPCOM Interface Reference">XPCOM Interface Reference</a></li><li><a href="https://developer.mozilla.org/en-US/docs/tag/Interfaces:Scriptable">Interfaces:Scriptable</a></li><li><a href="https://developer.mozilla.org/en-US/docs/tag/Messages">Messages</a></li></ul>
                  </div>
                                    <div class="contributor-sub"> <i aria-hidden="true" class="icon-group"></i><strong>Contributors to this page:</strong> <a href="https://developer.mozilla.org/en-US/profiles/Wjjohnst">Wjjohnst</a>, <a href="https://developer.mozilla.org/en-US/profiles/kscarfone">kscarfone</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a> </div>                                      <div class="contributor-sub">
                      <i aria-hidden="true" class="icon-clock-o"></i><strong>Last updated by:</strong>
                      <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>,
                      <time datetime="2014-04-14T10:42:26-07:00">Apr 14, 2014 10:42:26 AM</time>
                    </div>
                                  </div>
                          </div>

                      </div>
        </div>
      </div>
    </div> <!-- ends "main-content" -->

  <menu type="context" id="edit-history-menu">
    <menuitem data-action="$edit" label="Edit page"></menuitem>
    <menuitem data-action="$history" label="View page history"></menuitem>
  </menu>
  </div></main>

  <!-- Footer -->
  <footer><div class="center">
    <div class="column-container">
      <div class="column-main">
                <p>
          <bdi>&copy; 2005-2014 Mozilla Developer Network and individual contributors<br /> Content is available under <a href="https://developer.mozilla.org/en-US/docs/Project:MDN/About#Copyrights_and_licenses">these licenses</a> &middot; <a href="https://developer.mozilla.org/en-US/docs/Project:MDN/About">About MDN</a> &middot; <a href="http://github.com/mozilla/kuma">Contribute to the code</a> &middot; <a href="http://www.mozilla.org/privacy/websites/">Privacy policy</a></bdi>        </p>
              </div>
      <div class="column-strip">
                                  </div>
    </div>
  </div></footer>

  <!-- site js -->
    <script src="https://developer.mozilla.org/en-US/jsi18n/build:9fd3034"></script>
  
      <!--[if lte IE 8]><script src="/media/redesign/js/libs/selectivizr-1.0.2/selectivizr-build.js?build=9fd3034"></script><![endif]-->

    <script src="../../../../../../../../developer.cdn.mozilla.net/media/js/main-min46d5.js?build=9fd3034"></script>

          <script>
        mdn.analytics.trackOutboundLinks(document.body);
      </script>
    
          <script src="../../../../../../../../developer.cdn.mozilla.net/media/js/wiki-min46d5.js?build=9fd3034"></script>
      
    <script type="text/javascript">
      jQuery('.from-search-toc').mozSearchResults('');
  </script>

  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"beacon-3.newrelic.com","queueTime":1,"licenseKey":"42869b6ed3","agent":"js-agent.newrelic.com/nr-411.min.js","transactionName":"b1QHMUtVDRdSW0YKXVYeIxBXVxcNXFYdFFtTWEsTUFEUFwlcXQBHVVQLEQ==","applicationID":"3172075","errorBeacon":"bam.nr-data.net","applicationTime":295}</script></body>

<!-- Mirrored from developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Aug 2014 20:19:50 GMT -->
</html>